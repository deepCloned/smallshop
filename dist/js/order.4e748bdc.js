(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["order"],{1169:function(t,e,r){var n=r("2d95");t.exports=Array.isArray||function(t){return"Array"==n(t)}},"11e9":function(t,e,r){var n=r("52a7"),a=r("4630"),s=r("6821"),o=r("6a99"),i=r("69a8"),c=r("c69a"),u=Object.getOwnPropertyDescriptor;e.f=r("9e1e")?u:function(t,e){if(t=s(t),e=o(e,!0),c)try{return u(t,e)}catch(r){}if(i(t,e))return a(!n.f.call(t,e),t[e])}},1680:function(t,e,r){"use strict";var n=r("1c38"),a=r.n(n);a.a},"1af4":function(t,e,r){},"1c38":function(t,e,r){},"21f8":function(t,e,r){"use strict";var n=r("1af4"),a=r.n(n);a.a},"37c8":function(t,e,r){e.f=r("2b4c")},"3a72":function(t,e,r){var n=r("7726"),a=r("8378"),s=r("2d00"),o=r("37c8"),i=r("86cc").f;t.exports=function(t){var e=a.Symbol||(a.Symbol=s?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||i(e,t,{value:o.f(t)})}},"67ab":function(t,e,r){var n=r("ca5a")("meta"),a=r("d3f4"),s=r("69a8"),o=r("86cc").f,i=0,c=Object.isExtensible||function(){return!0},u=!r("79e5")((function(){return c(Object.preventExtensions({}))})),l=function(t){o(t,n,{value:{i:"O"+ ++i,w:{}}})},f=function(t,e){if(!a(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!s(t,n)){if(!c(t))return"F";if(!e)return"E";l(t)}return t[n].i},d=function(t,e){if(!s(t,n)){if(!c(t))return!0;if(!e)return!1;l(t)}return t[n].w},h=function(t){return u&&v.NEED&&c(t)&&!s(t,n)&&l(t),t},v=t.exports={KEY:n,NEED:!1,fastKey:f,getWeak:d,onFreeze:h}},"7bbc":function(t,e,r){var n=r("6821"),a=r("9093").f,s={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],i=function(t){try{return a(t)}catch(e){return o.slice()}};t.exports.f=function(t){return o&&"[object Window]"==s.call(t)?i(t):a(n(t))}},"7f7f":function(t,e,r){var n=r("86cc").f,a=Function.prototype,s=/^\s*function ([^ (]*)/,o="name";o in a||r("9e1e")&&n(a,o,{configurable:!0,get:function(){try{return(""+this).match(s)[1]}catch(t){return""}}})},"8a81":function(t,e,r){"use strict";var n=r("7726"),a=r("69a8"),s=r("9e1e"),o=r("5ca1"),i=r("2aba"),c=r("67ab").KEY,u=r("79e5"),l=r("5537"),f=r("7f20"),d=r("ca5a"),h=r("2b4c"),v=r("37c8"),m=r("3a72"),p=r("d4c0"),g=r("1169"),y=r("cb7c"),b=r("d3f4"),S=r("4bf8"),O=r("6821"),C=r("6a99"),L=r("4630"),_=r("2aeb"),w=r("7bbc"),k=r("11e9"),P=r("2621"),A=r("86cc"),j=r("0d58"),$=k.f,x=A.f,N=w.f,D=n.Symbol,T=n.JSON,E=T&&T.stringify,F="prototype",I=h("_hidden"),M=h("toPrimitive"),J={}.propertyIsEnumerable,G=l("symbol-registry"),K=l("symbols"),V=l("op-symbols"),B=Object[F],H="function"==typeof D&&!!P.f,R=n.QObject,W=!R||!R[F]||!R[F].findChild,Y=s&&u((function(){return 7!=_(x({},"a",{get:function(){return x(this,"a",{value:7}).a}})).a}))?function(t,e,r){var n=$(B,e);n&&delete B[e],x(t,e,r),n&&t!==B&&x(B,e,n)}:x,q=function(t){var e=K[t]=_(D[F]);return e._k=t,e},z=H&&"symbol"==typeof D.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof D},Q=function(t,e,r){return t===B&&Q(V,e,r),y(t),e=C(e,!0),y(r),a(K,e)?(r.enumerable?(a(t,I)&&t[I][e]&&(t[I][e]=!1),r=_(r,{enumerable:L(0,!1)})):(a(t,I)||x(t,I,L(1,{})),t[I][e]=!0),Y(t,e,r)):x(t,e,r)},U=function(t,e){y(t);var r,n=p(e=O(e)),a=0,s=n.length;while(s>a)Q(t,r=n[a++],e[r]);return t},X=function(t,e){return void 0===e?_(t):U(_(t),e)},Z=function(t){var e=J.call(this,t=C(t,!0));return!(this===B&&a(K,t)&&!a(V,t))&&(!(e||!a(this,t)||!a(K,t)||a(this,I)&&this[I][t])||e)},tt=function(t,e){if(t=O(t),e=C(e,!0),t!==B||!a(K,e)||a(V,e)){var r=$(t,e);return!r||!a(K,e)||a(t,I)&&t[I][e]||(r.enumerable=!0),r}},et=function(t){var e,r=N(O(t)),n=[],s=0;while(r.length>s)a(K,e=r[s++])||e==I||e==c||n.push(e);return n},rt=function(t){var e,r=t===B,n=N(r?V:O(t)),s=[],o=0;while(n.length>o)!a(K,e=n[o++])||r&&!a(B,e)||s.push(K[e]);return s};H||(D=function(){if(this instanceof D)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function(r){this===B&&e.call(V,r),a(this,I)&&a(this[I],t)&&(this[I][t]=!1),Y(this,t,L(1,r))};return s&&W&&Y(B,t,{configurable:!0,set:e}),q(t)},i(D[F],"toString",(function(){return this._k})),k.f=tt,A.f=Q,r("9093").f=w.f=et,r("52a7").f=Z,P.f=rt,s&&!r("2d00")&&i(B,"propertyIsEnumerable",Z,!0),v.f=function(t){return q(h(t))}),o(o.G+o.W+o.F*!H,{Symbol:D});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),at=0;nt.length>at;)h(nt[at++]);for(var st=j(h.store),ot=0;st.length>ot;)m(st[ot++]);o(o.S+o.F*!H,"Symbol",{for:function(t){return a(G,t+="")?G[t]:G[t]=D(t)},keyFor:function(t){if(!z(t))throw TypeError(t+" is not a symbol!");for(var e in G)if(G[e]===t)return e},useSetter:function(){W=!0},useSimple:function(){W=!1}}),o(o.S+o.F*!H,"Object",{create:X,defineProperty:Q,defineProperties:U,getOwnPropertyDescriptor:tt,getOwnPropertyNames:et,getOwnPropertySymbols:rt});var it=u((function(){P.f(1)}));o(o.S+o.F*it,"Object",{getOwnPropertySymbols:function(t){return P.f(S(t))}}),T&&o(o.S+o.F*(!H||u((function(){var t=D();return"[null]"!=E([t])||"{}"!=E({a:t})||"{}"!=E(Object(t))}))),"JSON",{stringify:function(t){var e,r,n=[t],a=1;while(arguments.length>a)n.push(arguments[a++]);if(r=e=n[1],(b(e)||void 0!==t)&&!z(t))return g(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!z(e))return e}),n[1]=e,E.apply(T,n)}}),D[F][M]||r("32e9")(D[F],M,D[F].valueOf),f(D,"Symbol"),f(Math,"Math",!0),f(n.JSON,"JSON",!0)},9093:function(t,e,r){var n=r("ce10"),a=r("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,a)}},ac4d:function(t,e,r){r("3a72")("asyncIterator")},ac6a:function(t,e,r){for(var n=r("cadf"),a=r("0d58"),s=r("2aba"),o=r("7726"),i=r("32e9"),c=r("84f2"),u=r("2b4c"),l=u("iterator"),f=u("toStringTag"),d=c.Array,h={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},v=a(h),m=0;m<v.length;m++){var p,g=v[m],y=h[g],b=o[g],S=b&&b.prototype;if(S&&(S[l]||i(S,l,d),S[f]||i(S,f,g),c[g]=d,y))for(p in n)S[p]||s(S,p,n[p],!0)}},cf2a:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"order"},[r("nav-bar",{attrs:{title:"订单详情"},on:{onLeft:t.goBack}}),"orderlist"===t.from?r("div",{staticClass:"order-info"},[r("div",{staticClass:"info-left"},[r("p",[r("span",[t._v("下单时间：")]),r("span",[t._v(t._s(t.createdDate))])]),r("p",[r("span",[t._v("订单编号：")]),r("span",[t._v(t._s(t.serialNumber))])])]),r("div",{staticClass:"info-right"},[t._v("待付款")])]):t._e(),t.address.name?r("div",{staticClass:"address-info"},[r("div",{staticClass:"address-main"},[r("div",{staticClass:"name-tel"},[r("p",[r("span",{staticClass:"iconfont icon-common"},[t._v("")]),r("span",[t._v(t._s(t.address.name))])]),r("p",[r("span",{staticClass:"iconfont icon-common"},[t._v("")]),r("span",[t._v(t._s(t.address.tel))])])]),r("div",{staticClass:"address"},[t._v(t._s(t.address.address))])]),r("div",{staticClass:"iconfont icon-right",on:{click:t.goAddress}},[t._v("")])]):r("div",{staticClass:"address-no",on:{click:t.addAddress}},[r("span",{staticClass:"add"},[t._v("添加地址")]),r("span",{staticClass:"iconfont icon-add"},[t._v("")])]),r("ul",{staticClass:"products-list"},t._l(t.products,(function(e){return r("li",{key:e.id,staticClass:"list-item"},[r("div",{staticClass:"image"},[r("img",{attrs:{src:""+t.publicPath+e.image}})]),r("p",{staticClass:"item-info"},[r("span",[t._v(t._s(e.name))]),r("span",[t._v("￥"+t._s(e.price))])]),r("p",{staticClass:"item-count"},[t._v("x"+t._s(e.counts))])])})),0),r("div",{staticClass:"bottom"},[r("div",{staticClass:"order-account"},[r("span",{staticClass:"account-info"},[t._v("付款合计: ")]),r("span",{staticClass:"account-num"},[t._v("￥"+t._s(t.account))])]),r("input",{staticClass:"go-pay",class:[t.products.length?"":"disabled"],attrs:{type:"button",value:"去付款"},on:{click:t.goPay}})])],1)},a=[],s=(r("e7e5"),r("d399")),o=(r("e17f"),r("2241")),i=(r("7f7f"),r("d000")),c=r("d823"),u=r("f4fc"),l=r("f9ff"),f=new c["a"],d=new u["a"],h=new l["a"],v={name:"order",data:function(){return{products:null,from:null,publicPath:"/",address:{},account:0,serialNumber:null,createdDate:null,id:null}},components:{NavBar:i["a"]},methods:{getDefalutAddress:function(){var t=this;d.getAddress(!0).then((function(e){e&&(t.address=e)}))},goAddress:function(){this.$router.push({name:"addresses",params:{from:"order"}})},addAddress:function(){this.$router.push({name:"addaddress",params:{from:"order"}})},goBack:function(){this.$router.go(-1)},goPay:function(){var t=this;this.address.name?this.products.length?"orderlist"===this.from?this.$dialog.confirm({title:"付款",message:"立即支付"}).then((function(){h.payment(t.id).then((function(e){t.$toast.success("付款成功"),t.$router.push({name:"orderlist"})}))})).catch((function(){t.$toast.fail("未支付"),t.$router.push({name:"orderlist"})})):o["a"].confirm({title:"付款",message:"确认提交付款"}).then((function(){t.$toast("正在创建订单...");var e={username:localStorage.getItem("username"),receiver:t.address.name,address:t.address.address,tel:t.address.tel,account:t.account,allCount:f.calcProductCount(t.products),products:t.products};h.generateOrder(e).then((function(e){f.removeOrderProduct(),t.$toast(e.message),t.$toast("订单创建成功"),t.$dialog.confirm({title:"付款",message:"立即支付"}).then((function(){h.payment(e.id).then((function(e){t.$toast.success("付款成功"),t.$router.push({name:"orderlist"})}))})).catch((function(){t.$toast.fail("未支付"),t.$router.push({name:"orderlist"})}))})).catch((function(){t.$toast("订单创建失败，请重试")}))})).catch((function(){Object(s["a"])("未创建订单")})):this.$toast("暂无待付款商品"):this.$toast("请添加地址！")},changeAddress:function(){if(this.from=this.$route.params.from,console.log(this.from),"addresses"===this.from)this.address=this.$route.params.address;else if("orderlist"===this.from){var t=this.$route.params.val;this.address={name:t.receiver,tel:t.tel,address:t.address},this.serialNumber=t.serialNumber,this.createdDate=t.created_at,this.account=t.account,this.products=JSON.parse(t.products),this.id=t.id}else this.getDefalutAddress()}},created:function(){this.products=f.getDataFromLocal(!0),this.account=f.calcProductAccount(this.products),this.changeAddress(),console.log(this.$route.params.from)}},m=v,p=(r("1680"),r("2877")),g=Object(p["a"])(m,n,a,!1,null,"0c2d57dc",null);e["default"]=g.exports},d000:function(t,e,r){"use strict";var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"nav-bar"},[r("header",[r("van-row",[r("van-col",{staticClass:"col",attrs:{span:"3"}},[r("span",{staticClass:"iconfont icon-arrow",on:{click:t.handleClick}},[t._v("")])]),r("van-col",{staticClass:"col",attrs:{span:"8",offset:"5"}},[t._v(t._s(t.title))]),r("van-col",{staticClass:"col",attrs:{span:"4",offset:"4"}},[r("span",{staticClass:"iconfont icon-dot"},[t._v("")])])],1)],1)])},a=[],s={name:"navbar",props:{title:{type:String,default:"小商铺"}},methods:{handleClick:function(){this.$emit("onLeft")}}},o=s,i=(r("21f8"),r("2877")),c=Object(i["a"])(o,n,a,!1,null,"4664ac92",null);e["a"]=c.exports},d4c0:function(t,e,r){var n=r("0d58"),a=r("2621"),s=r("52a7");t.exports=function(t){var e=n(t),r=a.f;if(r){var o,i=r(t),c=s.f,u=0;while(i.length>u)c.call(t,o=i[u++])&&e.push(o)}return e}},d823:function(t,e,r){"use strict";r("ac4d"),r("8a81"),r("ac6a");var n=r("d225"),a=r("b0b4"),s=function(){function t(){Object(n["a"])(this,t),this.storageKey="shopcar"}return Object(a["a"])(t,[{key:"addCount",value:function(t,e){var r=this.getDataFromLocal(),n=this.getIndex(t.id,r);-1===n?(t.counts=e,t.selected=!0,r.push(t)):(r[n].selected=!0,r[n].counts+=e),localStorage.setItem(this.storageKey,JSON.stringify(r))}},{key:"getCount",value:function(t){var e=0,r=this.getDataFromLocal();return r.forEach((function(r){t?r.selected&&(e+=r.counts):e+=r.counts})),e}},{key:"removeGoods",value:function(t){var e=this.getDataFromLocal(),r=e.filter((function(e){return e.id!==t}));localStorage.setItem(this.storageKey,JSON.stringify(r))}},{key:"changeGoodsSelected",value:function(t){var e=this.getDataFromLocal(),r=this.getIndex(t,e);e[r].selected=!e[r].selected,this.setLocalStorage(e)}},{key:"toggleAllSeleted",value:function(t){var e=this.getDataFromLocal(),r=!0,n=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var i=s.value;i.selected=!t}}catch(c){n=!0,a=c}finally{try{r||null==o.return||o.return()}finally{if(n)throw a}}this.setLocalStorage(e)}},{key:"getDataFromLocal",value:function(t){var e=localStorage.getItem(this.storageKey);if(!e)return[];var r=JSON.parse(e);return t?r.filter((function(t){return!0===t.selected})):r}},{key:"setLocalStorage",value:function(t){localStorage.setItem(this.storageKey,JSON.stringify(t))}},{key:"getIndex",value:function(t,e){for(var r=0;r<e.length;r++)if(e[r].id===t)return r;return-1}},{key:"calcProductAccount",value:function(t){var e=0,r=100;return t.forEach((function(t){e+=t.price*r*t.counts})),e/r}},{key:"calcProductCount",value:function(t){var e=0;return t.forEach((function(t){e+=t.counts})),e}},{key:"removeOrderProduct",value:function(){var t=this.getDataFromLocal(),e=t.filter((function(t){return!1===t.selected}));this.setLocalStorage(e)}}]),t}();e["a"]=s},f4fc:function(t,e,r){"use strict";r("ac4d"),r("8a81"),r("ac6a");var n=r("d225"),a=r("b0b4"),s=r("308d"),o=r("6bb5"),i=r("4e2b"),c=r("a75b"),u=function(t){function e(){return Object(n["a"])(this,e),Object(s["a"])(this,Object(o["a"])(e).call(this))}return Object(i["a"])(e,t),Object(a["a"])(e,[{key:"getAddress",value:function(t){var e=localStorage.getItem("username");return this.getAxios({url:"/user/address/get",data:{user:e},method:"POST"}).then((function(e){var r=e.addresses;if(0===r.length)return{};if(!t)return r;var n=!0,a=!1,s=void 0;try{for(var o,i=r[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){var c=o.value;if(!0===c.isDefault)return c}}catch(u){a=!0,s=u}finally{try{n||null==i.return||i.return()}finally{if(a)throw s}}}))}},{key:"addAddress",value:function(t){return this.getAxios({url:"/user/address/add",method:"POST",data:t})}},{key:"changeAddress",value:function(t,e){return this.getAxios({url:"/user/address/change/".concat(t),method:"POST",data:e})}},{key:"deleteAddress",value:function(t){return this.getAxios({url:"/user/address/delete/".concat(t)})}}]),e}(c["a"]);e["a"]=u},f9ff:function(t,e,r){"use strict";var n=r("d225"),a=r("b0b4"),s=r("308d"),o=r("6bb5"),i=r("4e2b"),c=r("a75b"),u=function(t){function e(){return Object(n["a"])(this,e),Object(s["a"])(this,Object(o["a"])(e).call(this))}return Object(i["a"])(e,t),Object(a["a"])(e,[{key:"generateOrder",value:function(t){return this.getAxios({url:"/product/order",method:"POST",data:t})}},{key:"payment",value:function(t){return this.getAxios({url:"/product/order/ordering",method:"POST",data:{id:t}})}},{key:"getOrderList",value:function(t){return this.getAxios({url:"/product/order/all",method:"POST",data:{username:t}})}}]),e}(c["a"]);e["a"]=u}}]);
//# sourceMappingURL=order.4e748bdc.js.map